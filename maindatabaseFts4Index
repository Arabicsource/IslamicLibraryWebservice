
#CREATE_BOOK_TITLES_FTS_TABLE
CREATE VIRTUAL TABLE IF NOT EXISTS BookNameTextSearch USING fts4(content="" , title);

#POPULATE_BOOKS_TITLES_FTS_SQL
INSERT OR REPLACE INTO BookNameTextSearch(docid , title)VALUES (? ,  ?);

#OPTIMIZE_BOOK_TITLES_FTS
INSERT INTO BookNameTextSearch(BookNameTextSearch) VALUES('optimize');

#CREATE_AUTHORS_NAMES_FTS_TABLE
CREATE VIRTUAL TABLE IF NOT EXISTS AuthorsNamesTextSearch USING fts4(content="" ,  name);

#OPTIMIZE_AUTHORS_NAME_FTS
INSERT INTO AuthorsNamesTextSearch(AuthorsNamesTextSearch)VALUES('optimize');

#Sample search
SELECT
booksauthors.bookid, books.title, authors.name, booksauthors.authorid, stored_books_table.STATUS
FROM
books Left  JOIN stored_books_table ON stored_books_table.bookid = books.id 
JOIN booksauthors ON booksauthors.bookid = books.id 
JOIN authors ON booksauthors.authorid = authors.id 
JOIN bookscategories ON bookscategories.bookid = books.id
WHERE
books.id IN ( SELECT BookNameTextSearch.docid FROM BookNameTextSearch WHERE BookNameTextSearch.title match ? )
